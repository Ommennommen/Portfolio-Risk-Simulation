# Portfolio Risk Simulation – Efficient Frontier

This project simulates portfolio performance using **Monte Carlo simulation in C++** and visualises the resulting **Efficient Frontier** in Python.

## Overview
The Efficient Frontier, a concept from Modern Portfolio Theory, represents the set of optimal portfolios that offer the highest expected return for a given level of risk.  
This project:
- Reads historical daily returns from a CSV
- Simulates thousands of random portfolios
- Calculates expected return, volatility, and Sharpe ratio
- Visualises the efficient frontier and highlights the max-Sharpe portfolio

---

## Data
- **Assets:** SPY (S&P 500 ETF), QQQ (Nasdaq-100 ETF), GLD (Gold ETF)  
- **Period:** Last 2 years of daily adjusted closes  
- **Source:** Yahoo Finance via `yfinance` (Python)

Daily returns are saved to `returns.csv` and used as input to the C++ simulation.

---

## Methodology

### 1) Data Preparation (Python)
- Download historical prices using `yfinance`
- Calculate daily returns
- Save to `returns.csv`

```bash
python make_returns.py
```

### 2) Monte Carlo Simulation (C++)
- Read `returns.csv`
- Compute mean returns vector & covariance matrix
- Generate `N` random portfolios (weights sum to 1, no shorts)
- Calculate expected return, volatility (σ), and Sharpe ratio
- Save results to `portfolios.csv`

Compile and run (example):
```bash
g++ -O2 -std=c++17 portfolio_simulation.cpp -o portfolio_simulation
./portfolio_simulation returns.csv 10000 0.02 1
#                              ^N    ^rf  ^annualize (1=yes, 0=no)
```

### 3) Visualisation (Python)
- Plot portfolios as a scatter coloured by Sharpe ratio
- Highlight the **max Sharpe** portfolio with a red star
- Axes: Volatility (σ) vs Expected Return (μ)

```bash
python plot_portfolios.py
```

---

## Repo Structure
```
.
├─ data/
│  └─ returns.csv              # generated by make_returns.py
├─ figures/
│  └─ efficient_frontier.png   # generated by plot_portfolios.py
├─ src/
│  └─ portfolio_simulation.cpp
├─ make_returns.py
├─ plot_portfolios.py
├─ portfolios.csv              # generated by C++ simulation
└─ README.md
```

---

## Example Commands

Generate returns (Python):
```bash
python make_returns.py
```

Run simulation (C++):
```bash
g++ -O2 -std=c++17 src/portfolio_simulation.cpp -o portfolio_simulation
./portfolio_simulation data/returns.csv 20000 0.02 1
```

Plot efficient frontier (Python):
```bash
python plot_portfolios.py
```

---

## Requirements

**Python**
```bash
pip install yfinance pandas matplotlib
```

**C++**
- Any C++17-compatible compiler (e.g., `g++`)

---

## Troubleshooting

- **“Empty CSV file.”**  
  Your `returns.csv` is missing or has the wrong format. Regenerate it with `make_returns.py`. The first row must be:
  ```
  date,GLD,QQQ,SPY
  ```
  followed by numeric daily returns.

- **NaNs in returns**  
  Ensure you’re using adjusted closes and calling `pct_change().dropna()` in `make_returns.py`.

- **CSV path issues**  
  Use absolute paths or quote paths with spaces:
  ```bash
  ./portfolio_simulation "/full/path/to/returns.csv" 10000 0.02 1
  ```

---

## Possible Extensions
- Add more assets (equities, bonds, commodities)
- Impose constraints (e.g., weight caps)
- Sensitivity analysis on risk-free rate
- Optimisation to trace the exact frontier (quadratic programming)

---

## License
MIT
